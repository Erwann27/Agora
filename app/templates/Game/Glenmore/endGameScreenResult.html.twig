{#
	This section displays if the current user is the winner and if not, the name of the winner is displayed.
	Comes with a button to the homepage and another one to the game's homepage

	@return :   display the winner and buttons to the game and platform's homepage
#}

<div id="endGameScreen"
     class="absolute top-0 left-0 w-full h-full bg-black bg-opacity-70 flex z-50 hidden text-white items-center justify-center">
	<div class="bg-slate-900 p-5 rounded-lg flex flex-col justify-center items-center">
		<p class="text-2xl">PARTIE TERMINEE</p>
		<p id="winner" class="text-4xl font-bold mb-4"></p>
		<div class="font-bold">
			<a href="{{ path('app_home') }}" class="rounded-l-lg bg-amber-300 text-black py-2 px-3 inline-flex portrait:text-2xl items-center">
				<svg class="me-2 portrait:size-10 landscape:size-5" xmlns="http://www.w3.org/2000/svg"
				     viewBox="0 0 24 24">
					<path d="M11 21h8v-2l1-1v4h-9v2l-10-3v-18l10-3v2h9v5l-1-1v-3h-8v18zm10.053-9l-3.293-3.293.707-.707
                    4.5 4.5-4.5 4.5-.707-.707 3.293-3.293h-9.053v-1h9.053z"></path>
				</svg>
				Retour à l'accueil
			</a>
			<a href="{{ path('app_game_glenmore_list')  }}" class="flex rounded-r-lg bg-violet-600 py-2 px-3 inline-flex portrait:text-2xl items-center">
				<svg class="me-2 portrait:size-10 landscape:size-5" xmlns="http://www.w3.org/2000/svg"
				     viewBox="0 0 24 24">
					<path fill="currentColor" d="M13.5 2c-5.621 0-10.211 4.443-10.475 10h-3.025l5 6.625
                    5-6.625h-2.975c.257-3.351 3.06-6 6.475-6 3.584 0 6.5 2.916 6.5 6.5s-2.916 6.5-6.5 6.5c-1.863
                    0-3.542-.793-4.728-2.053l-2.427 3.216c1.877 1.754 4.389 2.837 7.155 2.837 5.79 0 10.5-4.71
                    10.5-10.5s-4.71-10.5-10.5-10.5z"></path>
				</svg>
				Relancer une partie
			</a>
		</div>
	</div>
</div>

<script>


    function gameFinished(username) {
        //clearInterval(clockID);
        document.getElementById('endGameScreen').classList.remove('hidden');
        if (username === null) {
            document.getElementById('winner').textContent = 'Match nul ! 🤝';
        }
        else if (username === "{{ player.username }}") {
            document.getElementById('winner').textContent = 'Bravo ! 👏 Vous avez gagné la partie';
        } else {
            document.getElementById('winner').textContent = 'Dommage ! 😖 Vous avez perdu la partie';
        }
        document.body.style.overflow = 'hidden';
    }

    {% if isGameFinished %}
		{% set winner = null %}
		{# Arbitrary value impossible to reach  #}
		{% set winnerScore = 0 %}
		{% for player in game.players %}
			{% if player.points > winnerScore %}
				{% set winnerScore = player.points %}
				{% set winner = player.username %}
			{% elseif player.points == winnerScore %}
				{% set winner = null %}
			{% endif %}
		{% endfor %}

		gameFinished("{{ winner }}");
    {% endif %}

</script>