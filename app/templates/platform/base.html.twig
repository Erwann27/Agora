<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>
			{% block title %}Bienvenue!
			{% endblock %}
		</title>
		<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text></svg>">
		{% block stylesheets %}
			{{ encore_entry_link_tags('app') }}
		{% endblock %}

		{% block javascripts %}
			{% block importmap %}
				{{ importmap('app') }}
			{% endblock %}
			{{ encore_entry_script_tags('app') }}
		{% endblock %}
	</head>
	<body>
		{% if app.request.getPathInfo() starts with '/dashboard' %}
			{% block dashboard_layout %}{% endblock %}
		{% else %}
			{% include 'platform/shared/navbar.html.twig' %}
			{% block body %}{% endblock %}
		{% endif %}
		<script src="{{ asset('js/Platform/notify.js') }}"></script>
		<script>
			let eventSource;
			{% if app.user %}
			eventSource = new EventSource("{{ mercure('agora/notifications/user/' ~ app.user.id)|escape('js') }}");
			{% else %}
			eventSource = new EventSource("{{ mercure('agora/notifications/user/null')|escape('js') }}");
			{% endif %}
			eventSource.onmessage = event => {
				const data = JSON.parse(event.data);
				notify(data.content, "Agora: ");
			}
		</script>
	</body>
</html>
